# .htaccess file for SETALKEL Next.js Application

# Enable mod_rewrite for URL rewriting
RewriteEngine On

# Set the default locale if none is specified
RewriteRule ^$ /ar/ [R=301,L]

# Redirect to the default locale (Arabic) if no locale is specified
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/?$ /ar/$1 [R=301,L]

# Handle internationalization routes
# For supported locales: en, fr, ar, kr, po, tur
RewriteRule ^(en|fr|ar|kr|po|tur)/?$ /$1/ [R=301,L]
RewriteRule ^(en|fr|ar|kr|po|tur)/(.*) /$1/$2 [L]

# Handle API requests
RewriteRule ^api/ - [L,NC]

# Handle static assets
RewriteCond %{REQUEST_FILENAME} \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ [NC]
RewriteRule .* - [L]

# Handle Next.js routes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* /index.html [L]

# Security settings
# Prevent directory listing
Options -Indexes

# Disable access to sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Disable access to .env files
<FilesMatch "^\.env">
    Order allow,deny
    Deny from all
</FilesMatch>

# Set cache control for static assets
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
    ExpiresByType application/x-font-ttf "access plus 1 year"
    ExpiresByType application/vnd.ms-fontobject "access plus 1 year"
</IfModule>

# Compress output
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# Set security headers
<IfModule mod_headers.c>
    # Protect against XSS attacks
    Header set X-XSS-Protection "1; mode=block"

    # Prevent MIME-type sniffing
    Header set X-Content-Type-Options "nosniff"

    # Prevent clickjacking
    Header set X-Frame-Options "SAMEORIGIN"

    # Enable HSTS (if using HTTPS)
    # Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

    # Set content type to UTF-8
    Header set Content-Type "text/html; charset=UTF-8"
</IfModule>

# Handle 404 errors
ErrorDocument 404 /not-found

# Handle 500 errors
ErrorDocument 500 /server-error
